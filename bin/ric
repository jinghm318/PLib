#!/usr/bin/env php
<?php
/**
 * Generates HTML version of README, INSTALL and COPYING
 *
 * @author Pontus Östlund <spam@poppa.se>
 * @version 0.1
 * @package PLib
 * @subpackage Tools
*/

if (version_compare(PHP_VERSION, '5.1', '<'))
	print("PHP version 5.1 or greater is required to run this script.\n")
	      and exit(1);

define('SRC_PATH', dirname(__FILE__). '/../src');
define('SPATH', SRC_PATH . '/__plib');

require_once SRC_PATH . '/PLib.php';
PLib::Import('Parser.Syntaxer.*');

$collectables = array('README', 'INSTALL', 'CHANGELOG');

try {
	foreach ($collectables as $file) {
		$path = SRC_PATH . "/$file";
		if (file_exists($path)) {
			$c = file_get_contents($path);
			$p = new STXMarkdown();
			$d = $p->transform($c);
			file_put_contents(SPATH . "/info/$file.html", "<div>$d</div>");
		}
	}
}
catch (Exception $e) {
	PLib::PrintException($e);
}
?>
